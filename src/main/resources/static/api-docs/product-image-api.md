# 商品图片接口文档

## 1. 上传商品图片

### 接口说明
- 接口名称：上传商品图片
- 接口路径：`POST /api/v1/products/images`
- 接口描述：上传商品相关的图片，支持多图上传
- 权限要求：需要用户登录

### 请求参数
#### 请求头
```
Content-Type: multipart/form-data
Authorization: Bearer {token}
```

#### 请求体
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| files | File[] | 是 | 图片文件数组，支持jpg、jpeg、png格式 |

### 响应参数
```json
{
    "code": 200,
    "message": "success",
    "data": [1, 2, 3]  // 图片ID列表
}
```

### 响应示例
```json
{
    "code": 200,
    "message": "success",
    "data": [1001, 1002, 1003]
}
```

### 错误码
| 错误码 | 说明 |
|--------|------|
| 401 | 未登录或token已过期 |
| 400 | 请求参数错误 |
| 413 | 文件大小超出限制 |
| 415 | 不支持的文件类型 |
| 500 | 服务器内部错误 |

## 2. 删除商品图片

### 接口说明
- 接口名称：删除商品图片
- 接口路径：`DELETE /api/v1/products/images/{imageId}`
- 接口描述：删除已上传的商品图片
- 权限要求：需要用户登录，且只能删除自己上传的图片

### 请求参数
#### 路径参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| imageId | Long | 是 | 图片ID |

#### 请求头
```
Authorization: Bearer {token}
```

### 响应参数
```json
{
    "code": 200,
    "message": "success",
    "data": null
}
```

### 响应示例
```json
{
    "code": 200,
    "message": "success",
    "data": null
}
```

### 错误码
| 错误码 | 说明 |
|--------|------|
| 401 | 未登录或token已过期 |
| 403 | 无权删除该图片 |
| 404 | 图片不存在 |
| 500 | 服务器内部错误 |

## 3. 图片访问说明

### 图片URL格式
```
{domain}/images/products/{yyyy}/{MM}/{dd}/{uuid}.{extension}
```

### 示例
```
https://example.com/images/products/2024/04/07/550e8400e29b41d4a716446655440000.jpg
```

### 图片存储说明
1. 图片存储在服务器的 `/data/images/products` 目录下
2. 按日期自动分类存储，格式为：`/products/年/月/日/`
3. 文件名使用UUID生成，确保唯一性
4. 支持的图片格式：jpg、jpeg、png
5. 单张图片大小限制：5MB

### 图片用途说明
1. 商品主图：用于商品列表展示
2. 商品详情图：用于商品详情页展示
3. 商品预览图：用于商品缩略图展示

## 4. 注意事项

1. 图片上传限制：
   - 单次最多上传9张图片
   - 单张图片大小不超过5MB
   - 仅支持jpg、jpeg、png格式

2. 图片删除限制：
   - 只能删除自己上传的图片
   - 已关联到商品的图片需要先解除关联才能删除

3. 图片存储说明：
   - 图片会按日期自动分类存储
   - 使用UUID作为文件名，避免文件名冲突
   - 保留原始文件扩展名

4. 安全性说明：
   - 所有图片上传接口都需要用户登录
   - 图片删除需要验证用户权限
   - 图片访问需要配置适当的访问控制 